import{c as B,o as F,a as E,b as R,h as _,d as k,g as I,r as h,v as L,s as Q,n as j,e as U,p as $,f as D,i as K,q as N,j as O,u as z,k as M,l as T,m as G,w as x,t as f,Q as H,x as J,y as w,z as A,A as W}from"./index-DIR6V6xD.js";import{Q as X}from"./QPage-DP8WAE0C.js";const Y=B({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(u,{slots:m,emit:c}){const v=I(),l=h(null);let i=0;const n=[];function g(e){const d=typeof e=="boolean"?e:u.noErrorFocus!==!0,y=++i,q=(t,o)=>{c(`validation${t===!0?"Success":"Error"}`,o)},C=t=>{const o=t.validate();return typeof o.then=="function"?o.then(r=>({valid:r,comp:t}),r=>({valid:!1,comp:t,err:r})):Promise.resolve({valid:o,comp:t})};return(u.greedy===!0?Promise.all(n.map(C)).then(t=>t.filter(o=>o.valid!==!0)):n.reduce((t,o)=>t.then(()=>C(o).then(r=>{if(r.valid===!1)return Promise.reject(r)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return y===i&&q(!0),!0;if(y===i){const{comp:o,err:r}=t[0];if(r!==void 0&&console.error(r),q(!1,o),d===!0){const V=t.find(({comp:P})=>typeof P.focus=="function"&&L(P.$)===!1);V!==void 0&&V.comp.focus()}}return!1})}function p(){i++,n.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function s(e){e!==void 0&&Q(e);const d=i+1;g().then(y=>{d===i&&y===!0&&(u.onSubmit!==void 0?c("submit",e):e?.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function a(e){e!==void 0&&Q(e),c("reset"),j(()=>{p(),u.autofocus===!0&&u.noResetFocus!==!0&&b()})}function b(){U(()=>{if(l.value===null)return;(l.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||l.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||l.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(l.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1))?.focus({preventScroll:!0})})}$(D,{bindComponent(e){n.push(e)},unbindComponent(e){const d=n.indexOf(e);d!==-1&&n.splice(d,1)}});let S=!1;return F(()=>{S=!0}),E(()=>{S===!0&&u.autofocus===!0&&b()}),R(()=>{u.autofocus===!0&&b()}),Object.assign(v.proxy,{validate:g,resetValidation:p,submit:s,reset:a,focus:b,getValidationComponents:()=>n}),()=>_("form",{class:"q-form",ref:l,onSubmit:s,onReset:a},k(m.default))}});function Z(){return K(N)}const ae=O({name:"LoginPage",__name:"LoginPage",setup(u){const m=h(""),c=h(""),v=h(!1),l=z(),i=M(),n=Z();async function g(){v.value=!0;try{await l.login({username:m.value,password:c.value}),i.push("/")}catch(p){console.error(p),n.notify({color:"negative",message:"Login failed",icon:"report_problem"})}finally{v.value=!1}}return(p,s)=>(T(),G(X,{class:"flex flex-center bg-background"},{default:x(()=>[f(H,{class:"q-pa-md",style:{width:"400px"}},{default:x(()=>[f(J,null,{default:x(()=>[s[2]||(s[2]=w("div",{class:"text-h6 text-center q-mb-md"},"Lila Chakra Admin",-1)),f(Y,{onSubmit:g,class:"q-gutter-md"},{default:x(()=>[f(A,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a),label:"Username",filled:"",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"]),f(A,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=a=>c.value=a),label:"Password",type:"password",filled:"",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"]),w("div",null,[f(W,{label:"Login",type:"submit",color:"primary",class:"full-width",loading:v.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{ae as default};
